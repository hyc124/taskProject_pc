(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7d673852"],{"394b":function(e,t,a){"use strict";var s=a("d51b"),n=a.n(s);n.a},"41ac":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"labelManage"},[s("header",{staticClass:"page-header"},[e._v(" 标签管理 "),e.delMore?s("div",{staticClass:"is-system",attrs:{id:"delBtn"}},[s("a-button",{on:{click:function(t){e.delMore=!1}}},[e._v("取消")]),s("a-button",{attrs:{type:"primary",disabled:e.addBtnShow},on:{click:function(t){return e.delData("delMore")}}},[e._v("确定")])],1):s("div",{staticClass:"is-system",attrs:{id:"optionBtn"}},[s("a-button",{on:{click:function(t){e.delMore=!0}}},[e._v("批量删除")]),s("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.openModal("add")}}},[e._v("添加")])],1)]),s("div",{staticClass:"split-box split-box-thin"}),s("div",{staticClass:"label-content"},[s("div",{staticClass:"section-title title"},[e._v("个人标签")]),e.data.length>0?s("a-checkbox-group",{model:{value:e.tableCheck,callback:function(t){e.tableCheck=t},expression:"tableCheck"}},[s("ul",{staticClass:"label-list",attrs:{id:"personUl"}},e._l(e.data,(function(t,a){return s("li",{key:a,attrs:{title:t.tag_name}},[e.delMore?s("a-checkbox",{attrs:{value:t.id}},[s("div",{staticClass:"label-list-li"},[s("div",{staticClass:" layout"},[s("span",{staticClass:"label-name"},[e._v(e._s(t.tag_name))]),e._v(" "),s("span",{staticClass:"count"},[e._v("(共"+e._s(t.num)+"人）")])]),s("div",{staticClass:"layout label-option"},[s("span",{staticClass:"seeData",on:{click:function(a){return e.openModal("see",t.id)}}},[s("i",{staticClass:"iconfont"},[e._v("")]),e._v("查看")]),s("span",{staticClass:"editData",on:{click:function(a){return e.openModal("edit",t.id)}}},[s("i",{staticClass:"iconfont"},[e._v("")]),e._v("编辑")]),s("span",{staticClass:"delData"},[s("i",{staticClass:"iconfont",on:{click:function(a){return e.delData(t.id)}}},[e._v("")]),e._v("删除")])])])]):s("div",{staticClass:"label-list-li"},[s("div",{staticClass:" layout"},[s("span",{staticClass:"label-name"},[e._v(" "+e._s(t.tag_name))]),e._v(" "),s("span",{staticClass:"count"},[e._v("(共"+e._s(t.num)+"人）")])]),s("div",{staticClass:"layout label-option"},[s("span",{staticClass:"seeData",on:{click:function(a){return e.openModal("see",t.id)}}},[s("i",{staticClass:"iconfont"},[e._v("")]),e._v("查看")]),s("span",{staticClass:"editData",on:{click:function(a){return e.openModal("edit",t.id)}}},[s("i",{staticClass:"iconfont"},[e._v("")]),e._v("编辑")]),s("span",{staticClass:"delData",on:{click:function(a){return e.delSure(t.id,1)}}},[s("i",{staticClass:"iconfont"},[e._v("")]),e._v("删除")])])])],1)})),0)]):s("div",{staticClass:"no-data"},[s("img",{staticClass:"no-data-img",attrs:{src:a("9485"),alt:"暂无数据"}})])],1),s("a-modal",{attrs:{title:e.modalTitle,visible:e.modalShow,"confirm-loading":e.confirmLoading,centered:!0,destroyOnClose:!0},on:{ok:e.modalSure,cancel:e.cancelModel}},[s("a-form-model",{ref:"formName",attrs:{model:e.form,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[s("a-form-model-item",{attrs:{label:"标签名称",prop:"name"}},[s("a-input",{attrs:{placeholder:"请输入标签名称(15字内)",maxLength:15,disabled:e.isSee},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),s("a-form-model-item",{attrs:{label:"标签人员",prop:"people"}},[s("select-people-tags",{ref:"selectPeople",attrs:{"people-arr":e.form.people,"can-edit":e.isSee}})],1)],1)],1)],1)},n=[],i=(a("99af"),a("a15b"),a("b0c0"),a("ac1f"),a("1276"),a("96cf"),a("1da1")),o=a("365c"),l=a("8061"),r={name:"labelManage",components:{SelectPeopleTags:l["a"]},data:function(){return{data:[],modalType:"add",modalShow:!1,confirmLoading:!1,labelCol:{span:4},wrapperCol:{span:18},form:{id:null,name:"",people:{dep:[],userId:[],user:[]},tagid:null},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"},{max:20,message:"输入字符应在20字内",trigger:"blur"}],people:[{required:!0,message:"排序不能为空",trigger:"change"}]},tableCheck:[],delMore:!1,modalTitle:"",addBtnShow:!1,isSee:!1}},watch:{data:function(e){e.length>=20&&(this.addBtnShow=!0)}},created:function(){this.getData()},methods:{getData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,s,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o["b"].getTags();case 2:a=t.sent,s=a.code,n=a.data,i=a.msg,s?(e.data=[].concat(n.personal),e.data.length>=20&&(e.addBtnShow=!0)):e.$message.error(i,2);case 7:case"end":return t.stop()}}),t)})))()},openModal:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var n,i,l,r;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(a.modalType=e,a.modalShow=!0,"add"===e?(a.modalTitle="新增标签",a.isSee=!1):"edit"===e?(a.modalTitle="编辑标签",a.isSee=!1):"see"===e&&(a.modalTitle="查看标签",a.isSee=!0),!t){s.next=14;break}return a.form.id=t,s.next=7,o["b"].getTagsUser({id:t});case 7:n=s.sent,i=n.code,l=n.data,r=n.msg,i?(console.log(l),a.form.name=l.data.tag_name,a.form.people.user=[].concat(l.data.userid_list),a.form.tagid=l.data.parent_id,a.form.people.dep=l.data.dep_list?l.data.dep_list.split(","):[],a.form.people.userId=l.data.userid?l.data.userid.split(","):[]):a.$message.error(r,2),s.next=15;break;case 14:a.form={id:null,name:"",people:{dep:[],userId:[],user:[]}};case 15:case"end":return s.stop()}}),s)})))()},modalSure:function(){var e=this;"see"==this.modalType?this.modalShow=!1:(console.log(this.$refs.selectPeople.peopleList),this.confirmLoading=!0,this.form.people.user=this.$refs.selectPeople.peopleList,this.form.people.dep=this.$refs.selectPeople.depId,this.form.people.userId=this.$refs.selectPeople.peopleId,this.$refs.formName.validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(a){var s,n,i,l,r,c,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(a&&e.form.people.user.length>0)){t.next=23;break}if(s=e.form.people.userId?e.form.people.userId.join(","):"",n=e.form.people.dep?e.form.people.dep.join(","):"",i={tag_name:e.form.name,userid:s,userid_list:s,dep_list:n},"add"!==e.modalType){t.next=11;break}return i.type=0,t.next=8,o["b"].addTags(i);case 8:l=t.sent,t.next=19;break;case 11:if("edit"!==e.modalType){t.next=19;break}return i.type=1,i.id=e.form.id,i.tagid=e.form.tagid,i.parent_id=e.form.tagid,t.next=18,o["b"].addTags(i);case 18:l=t.sent;case 19:r=l,c=r.code,d=r.msg,c?(e.confirmLoading=!1,e.$message.success(d,2),e.modalShow=!1,e.getData()):(e.confirmLoading=!0,e.$message.error(d,2)),t.next=26;break;case 23:return e.$message.error("检验失败，请检查输入项！",2),e.confirmLoading=!1,t.abrupt("return",!1);case 26:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()))},cancelModel:function(){this.modalShow=!1,this.$refs.formName.resetFields()},delData:function(){var e,t;this.delMore=!0,0===this.tableCheck.length?this.$message.warning("请选择要删除的数据",2):(e=this.tableCheck.join(","),t=this.tableCheck.length,this.delSure(e,t),this.delMore=!1)},delSure:function(e,t){var a=this;this.$confirm({title:"是否确定删除"+t+"项数据？",content:"",centered:!0,onOk:function(){return Object(i["a"])(regeneratorRuntime.mark((function t(){var s,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o["b"].delTags({id:e});case 2:s=t.sent,n=s.code,i=s.msg,n?(a.$message.success(i,2),a.getData()):a.$message.error(i,2);case 6:case"end":return t.stop()}}),t)})))()}})}}},c=r,d=(a("c102"),a("394b"),a("2877")),p=Object(d["a"])(c,s,n,!1,null,"4bb71480",null);t["default"]=p.exports},8061:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("a-button",{attrs:{disabled:e.canEdit},on:{click:function(t){e.pickUserShow=!0}}},[e._v("选择")]),a("p",{staticClass:"people-num see-none"},[e._v("已选"),a("span",{staticClass:"people-count"},[e._v(e._s(e.peopleList.length))]),e._v("人")]),a("a-button",{staticClass:"clear-all",attrs:{type:"link",disabled:e.canEdit},on:{click:e.closeAll}},[e._v("清空已选")])],1),a("div",{staticClass:"people-list"},e._l(e.peopleList,(function(t,s){return a("a-tag",{key:s,attrs:{closable:!e.canEdit},on:{close:function(t){return e.delPeople(t,s)}}},[e._v(e._s(t.name))])})),1),a("pick-user",{attrs:{show:e.pickUserShow,"selected-user":e.peopleList,"selecte-dep":e.depId,"filter-data":e.filterPeople},on:{"update:show":function(t){e.pickUserShow=t},done:e.addUser}})],1)},n=[],i=(a("99af"),a("4160"),a("a434"),a("b0c0"),a("159b"),a("adc3")),o={name:"selectPeopleTags",components:{PickUser:i["a"]},props:["peopleArr","canEdit","filterData"],data:function(){return{peopleList:[],peopleId:[],depId:[],pickUserShow:!1,filterPeople:this.filterData?this.filterData:[]}},watch:{peopleArr:{handler:function(e){var t=this;this.peopleList=e.user?e.user:e,this.peopleList.forEach((function(e){e.label=e.name})),this.peopleList.length>0?(this.peopleId=[],this.depId=[],this.peopleList.forEach((function(e){t.peopleId.push(e.userid),t.depId.push(e.dep_id)}))):(this.peopleId=[],this.depId=[])},deep:!0},filterData:function(e){e&&(this.filterPeople=this.filterPeople.concat(e))}},methods:{delPeople:function(e,t){return this.peopleList.splice(t,1),this.peopleId.splice(t,1),this.depId.splice(t,1),e.preventDefault(),!1},closeAll:function(){this.peopleList=[],this.peopleId=[],this.depId=[]},addUser:function(e){this.peopleList=[].concat(e.user),this.peopleId=[].concat(e.userId),this.depId=[].concat(e.dep)}}},l=o,r=(a("8b18"),a("2877")),c=Object(r["a"])(l,s,n,!1,null,"7dbae92d",null);t["a"]=c.exports},"8b18":function(e,t,a){"use strict";var s=a("dfb5"),n=a.n(s);n.a},9485:function(e,t,a){e.exports=a.p+"img/nodata.78203cc4.png"},b691:function(e,t,a){},c102:function(e,t,a){"use strict";var s=a("b691"),n=a.n(s);n.a},d51b:function(e,t,a){},dfb5:function(e,t,a){}}]);